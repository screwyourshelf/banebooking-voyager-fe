import{r as c,j as n}from"./shadcn-mOdBhBu9.js";import{u as D}from"./useSlug-DMGJr7eH.js";import{P as M}from"./Page-pTszYvfk.js";import{S as L}from"./SimpleTabsLazy-Cmj-F3Ld.js";import{c as S,L as y,B as T}from"./index-DACapAhf.js";import{S as h}from"./SettingsSection-DfNPesyK.js";import{a as x,S as g}from"./SettingsRow-SsVQpD69.js";import{S as p}from"./SettingsInput-vO4hYVrx.js";import{S as R}from"./SelectField-Lp4Czzit.js";import"./react-RGnvvjkK.js";import"./lucide-ByENZzyU.js";import"./index-Bb2dXpgu.js";import"./FieldWrapper-BhwyvJQg.js";function C({slug:l}){const{data:e,isLoading:m,oppdaterKlubb:u}=S(l),[t,a]=c.useState({navn:"",kontaktEpost:"",banereglement:"",latitude:"",longitude:"",feedUrl:"",feedSynligAntallDager:""});c.useEffect(()=>{e&&a({navn:e.navn??"",kontaktEpost:e.kontaktEpost??"",banereglement:e.banereglement??"",latitude:e.latitude?.toString()??"",longitude:e.longitude?.toString()??"",feedUrl:e.feedUrl??"",feedSynligAntallDager:(e.feedSynligAntallDager??50).toString()})},[e]);const d=c.useMemo(()=>e?(t.navn??"")!==(e.navn??"")||(t.kontaktEpost??"")!==(e.kontaktEpost??"")||(t.banereglement??"")!==(e.banereglement??"")||(t.latitude??"")!==(e.latitude?.toString()??"")||(t.longitude??"")!==(e.longitude?.toString()??"")||(t.feedUrl??"")!==(e.feedUrl??"")||(t.feedSynligAntallDager??"")!==(e.feedSynligAntallDager??50).toString():!1,[e,t]);if(m||!e)return n.jsx(y,{});function o(r){const i=r.trim();if(!i)return;const s=Number(i.replace(",","."));return Number.isFinite(s)?s:void 0}return n.jsxs("form",{className:"space-y-4",onSubmit:r=>{r.preventDefault();const i=o(t.latitude),s=o(t.longitude),b=o(t.feedSynligAntallDager);u.mutate({...e,navn:t.navn,kontaktEpost:t.kontaktEpost,banereglement:t.banereglement,latitude:i??e.latitude??null,longitude:s??e.longitude??null,feedUrl:t.feedUrl,feedSynligAntallDager:b??e.feedSynligAntallDager??50})},children:[n.jsx(h,{title:"Grunninfo",description:"Informasjon som vises utad i Banebooking.",children:n.jsxs(x,{children:[n.jsx(g,{title:"Klubbnavn",description:"Navnet på klubben slik det vises utad i Banebooking.",children:n.jsx(p,{value:t.navn,onChange:r=>a(i=>({...i,navn:r})),placeholder:"Ås tennisklubb",autoComplete:"organization"})}),n.jsx(g,{title:"Kontakt-e-post",description:"Vises på klubbens infoside. Brukes til henvendelser fra medlemmer og gjester.",children:n.jsx(p,{value:t.kontaktEpost,onChange:r=>a(i=>({...i,kontaktEpost:r})),placeholder:"post@klubb.no",type:"email",inputMode:"email",autoComplete:"email"})})]})}),n.jsx(h,{title:"Kart",description:"Valgfrie innstillinger for innhenting av værinformasjon.",children:n.jsxs(x,{children:[n.jsx(g,{title:"Latitude (breddegrad)",description:"",children:n.jsx(p,{value:t.latitude,onChange:r=>a(i=>({...i,latitude:r})),placeholder:"f.eks. 59.6552",inputMode:"decimal"})}),n.jsx(g,{title:"Longitude (lengdegrad)",description:"",children:n.jsx(p,{value:t.longitude,onChange:r=>a(i=>({...i,longitude:r})),placeholder:"f.eks. 10.7769",inputMode:"decimal"})})]})}),n.jsx(h,{title:"Feed",description:"Valgfrie innstillinger for innhenting nyheter fra klubbens RSS-feed.",children:n.jsxs(x,{children:[n.jsx(g,{title:"RSS-feed",description:"URL til klubbens RSS-feed (f.eks. nyheter). Hvis satt, hentes og vises de nyeste innleggene i appen.",children:n.jsx(p,{value:t.feedUrl,onChange:r=>a(i=>({...i,feedUrl:r})),placeholder:"https://www.aastk.no/?feed=rss2",inputMode:"url",type:"url"})}),n.jsx(g,{title:"Aldergrense for feedinnslag (dager)",description:"Hvor mange dager gamle innslag som vises. Sett til 0 for å inkludere alle.",children:n.jsx(p,{value:t.feedSynligAntallDager,onChange:r=>a(i=>({...i,feedSynligAntallDager:r})),type:"number",inputMode:"numeric",min:0,step:1})})]})}),n.jsx("div",{className:"flex justify-end",children:n.jsx(T,{type:"submit",size:"sm",disabled:!d||u.isPending,children:u.isPending?"Lagrer...":"Lagre endringer"})})]})}function f({id:l,value:e,onChange:m,min:u=0,max:t=10,step:a=1,disabled:d=!1}){return n.jsx("input",{id:l,type:"range",value:e,min:u,max:t,step:a,disabled:d,onChange:o=>m(parseInt(o.target.value,10)),className:"w-full"})}function P({title:l,description:e,id:m,value:u,onChange:t,options:a,disabled:d,className:o}){return n.jsx(g,{title:l,description:e,className:o,children:n.jsx(R,{id:m,label:l,hideLabel:!0,value:u,onChange:t,options:a,disabled:d})})}function j(l){const e=parseInt((l??"").split(":")[0]??"0",10);return Number.isFinite(e)?e:0}function k(l){return`${String(l).padStart(2,"0")}:00`}function E({slug:l}){const{data:e,isLoading:m,oppdaterKlubb:u}=S(l),[t,a]=c.useState({maksPerDag:1,maksTotalt:2,dagerFremITid:7,slotLengdeMinutter:60,aapningstid:"07:00",stengetid:"22:00"});c.useEffect(()=>{e?.bookingRegel&&a({maksPerDag:e.bookingRegel.maksPerDag??1,maksTotalt:e.bookingRegel.maksTotalt??2,dagerFremITid:e.bookingRegel.dagerFremITid??7,slotLengdeMinutter:e.bookingRegel.slotLengdeMinutter??60,aapningstid:e.bookingRegel.aapningstid??"07:00",stengetid:e.bookingRegel.stengetid??"22:00"})},[e]);const d=c.useMemo(()=>j(t.aapningstid),[t.aapningstid]),o=c.useMemo(()=>j(t.stengetid),[t.stengetid]);c.useEffect(()=>{if(d>=o){const i=Math.min(23,d+1);a(s=>({...s,stengetid:k(i)}))}},[d,o]);const r=c.useMemo(()=>{if(!e?.bookingRegel)return!1;const i=e.bookingRegel;return t.maksPerDag!==(i.maksPerDag??1)||t.maksTotalt!==(i.maksTotalt??2)||t.dagerFremITid!==(i.dagerFremITid??7)||t.slotLengdeMinutter!==(i.slotLengdeMinutter??60)||t.aapningstid!==(i.aapningstid??"07:00")||t.stengetid!==(i.stengetid??"22:00")},[e,t]);return m||!e?n.jsx(y,{}):n.jsxs("form",{className:"space-y-4",onSubmit:i=>{i.preventDefault(),u.mutate({navn:e.navn??"",kontaktEpost:e.kontaktEpost??"",banereglement:e.banereglement??"",latitude:e.latitude??null,longitude:e.longitude??null,feedUrl:e.feedUrl??null,feedSynligAntallDager:e.feedSynligAntallDager??7,bookingRegel:t})},children:[n.jsx(h,{title:"Bookinginnstillinger",description:"Styr åpningstider, hvor mange bookinger som er lov, og hvor langt frem man kan booke.",children:n.jsxs(x,{children:[n.jsx(g,{title:"Åpningstid",description:"Tidligste time det går an å booke.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:d}),children:n.jsx(f,{id:"aapningstid",value:d,min:6,max:23,onChange:i=>{const s=i,b=Math.max(o,s+1);a(v=>({...v,aapningstid:k(s),stengetid:k(Math.min(23,b))}))}})}),n.jsx(g,{title:"Stengetid",description:"Siste time som kan startes.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:o}),children:n.jsx(f,{id:"stengetid",value:o,min:6,max:23,onChange:i=>{const s=i,b=Math.min(d,s-1);a(v=>({...v,aapningstid:k(Math.max(6,b)),stengetid:k(s)}))}})}),n.jsx(g,{title:"Maks bookinger per dag",description:"Begrenser hvor mange bookinger én bruker kan ha på samme dag.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:t.maksPerDag}),children:n.jsx(f,{id:"maksPerDag",value:t.maksPerDag,min:0,max:5,onChange:i=>a(s=>({...s,maksPerDag:i}))})}),n.jsx(g,{title:"Maks aktive bookinger totalt",description:"Begrenser hvor mange aktive bookinger en bruker kan ha samtidig.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:t.maksTotalt}),children:n.jsx(f,{id:"maksTotalt",value:t.maksTotalt,min:0,max:10,onChange:i=>a(s=>({...s,maksTotalt:i}))})}),n.jsx(g,{title:"Dager frem i tid",description:"Hvor mange dager frem i tid det er mulig å booke.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:t.dagerFremITid}),children:n.jsx(f,{id:"dagerFremITid",value:t.dagerFremITid,min:1,max:14,onChange:i=>a(s=>({...s,dagerFremITid:i}))})}),n.jsx(P,{title:"Slot-lengde",description:"Hvor lange booking-slottene er (låst i denne versjonen).",id:"slotLengdeMinutter",value:t.slotLengdeMinutter.toString(),onChange:i=>a(s=>({...s,slotLengdeMinutter:parseInt(i,10)})),options:[{label:"30 minutter",value:"30"},{label:"45 minutter",value:"45"},{label:"60 minutter",value:"60"},{label:"90 minutter",value:"90"}],disabled:!0})]})}),n.jsx("div",{className:"flex justify-end",children:n.jsx(T,{type:"submit",size:"sm",disabled:!r||u.isPending,children:u.isPending?"Lagrer...":"Lagre endringer"})})]})}function $(){const[l,e]=c.useState("info"),m=D();return n.jsx(M,{children:n.jsx(L,{items:[{value:"info",label:"Klubbinnstillinger",content:n.jsx(C,{slug:m})},{value:"booking",label:"Bookinginnstillinger",content:n.jsx(E,{slug:m})}],value:l,onValueChange:e})})}export{$ as default};
