import{r as c,j as e,i as w,c as G,k as E,y as De,e as Q,f as Re,w as we,s as Se,l as I,I as Ce,P as Ee,z as Te}from"./shadcn-CGWS6Fka.js";import{P as Pe}from"./Page-cxAHLmJB.js";import{T as Ie}from"./Tabs-CIjVv54i.js";import{u as S,b as K,t as j,a as _e,c as V,f as x,L as _,g as W,e as Me,B as O,h as $e,F as Le,i as Ve,I as Oe,j as Be,l as Fe,m as Ge,n as Ke}from"./index-C3_SJj2x.js";import{R as N,P as R,a as T,b as P}from"./RowList-DthgaHi0.js";import{f as A,S as Ue,T as qe,a as He,b as $,c as L,d as ze,e as C,g as Qe,s as We,L as q}from"./table-rb_SL4c6.js";import{B as Ye}from"./BookingSlotItem-DNCgxA3n.js";import{b as Xe,c as Je}from"./lucide-C5rSQBgG.js";import{c as Y,R as Ze,T as et,W as tt,C as nt,a as rt,D as st,b as X,P as at,O as ot}from"./index-2r_zrsQA.js";import{u as it}from"./index-DnnwNeRP.js";import"./react-RGnvvjkK.js";import"./tabs-Da3dooiT.js";import"./switch-3Gj4XlTo.js";function lt(t=!1){const n=S(),r=K(["mineBookinger",n,t],`/klubb/${n}/bookinger/mine${t?"?inkluderHistoriske=true":""}`,{requireAuth:!0,staleTime:6e4}),a=c.useRef(!1);return c.useEffect(()=>{if(!r.error){a.current=!1;return}a.current||(j.error(r.error.message??"Ukjent feil ved henting av bookinger"),a.current=!0)},[r.error]),r}function ct(){const t=S(),n=_e(),r=()=>{n.invalidateQueries({queryKey:["mineBookinger",t]}),n.invalidateQueries({queryKey:["bookinger",t]})},a=V("delete",`/klubb/${t}/bookinger`,{onError:o=>{j.error(o.message??"Kunne ikke avbestille.")},onSuccess:()=>{j.info("Bookingen er avbestilt.")},onSettled:()=>{r()}});return{avbestill:o=>{a.mutate(o)},avbestillAsync:async o=>a.mutateAsync(o),isPending:a.isPending}}function B({label:t,value:n,description:r,className:a,density:s="default"}){return e.jsx(N,{title:t,description:r,density:s,className:a,children:e.jsx("div",{className:x("text-sm text-muted-foreground break-words"),children:n})})}function dt({slot:t}){const n=typeof t.temperatur=="number",r=typeof t.vind=="number";return!!t.værSymbol||n||r?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{children:A(t.dato)}),e.jsx("span",{className:"w-[18px] h-[18px] flex items-center justify-center",children:t.værSymbol?e.jsx("img",{src:`/banebooking-voyager-fe/weather-symbols/svg/${t.værSymbol}.svg`,alt:t.værSymbol,width:18,height:18,className:"select-none",draggable:!1}):e.jsx("span",{className:"invisible",children:"."})}),n||r?e.jsxs("span",{className:"text-[11px] text-muted-foreground",children:[n?`${t.temperatur}°`:null,n&&r?" · ":null,r?`${t.vind} m/s`:null]}):null]}):e.jsx("span",{className:"flex items-center gap-1",children:e.jsx("span",{children:A(t.dato)})})}function ut(t){return[...t].sort((n,r)=>{const a=new Date(r.dato).getTime()-new Date(n.dato).getTime();return a!==0?a:r.startTid.localeCompare(n.startTid)})}function gt(t){return`${t.baneId}-${t.dato}-${t.startTid}-${t.sluttTid}`}function pt({visHistoriske:t,onToggleVisHistoriske:n,bookinger:r,isPending:a,openKey:s,onToggleOpenKey:i,onAvbestill:o}){const d=r.length>0,g=t?"Du har ingen registrerte bookinger.":"Du har ingen kommende bookinger.";return e.jsxs(R,{title:"Bookinger",description:"Se kommende bookinger og velg om du vil inkludere tidligere.",children:[e.jsx(T,{children:e.jsxs(P,{children:[e.jsx(Ue,{title:"Vis også tidligere bookinger",description:"Inkluder bookinger som allerede er gjennomført.",checked:t,onCheckedChange:n}),d?null:e.jsx(N,{title:"Ingen bookinger",description:g})]})}),d?e.jsx("div",{className:a?"pointer-events-none opacity-60 mt-4":"mt-4",children:r.map(l=>{const u=gt(l),p=s===u,m=!!l.kanAvbestille&&!l.erPassert;return e.jsx(Ye,{slot:l,currentUser:null,erInteraktivOverride:m,isOpen:p,onToggle:()=>{m&&i(p?null:u)},onCancel:()=>o(l),headerOverrideTitle:l.baneNavn,headerLeftPrefix:e.jsx(dt,{slot:l})},u)})}):null]})}function mt(){const[t,n]=c.useState(!1),[r,a]=c.useState(null),{data:s=[],isLoading:i}=lt(t),{avbestillAsync:o,isPending:d}=ct(),g=c.useMemo(()=>ut(s),[s]);async function l(u){d||(await o({baneId:u.baneId,dato:u.dato,startTid:u.startTid,sluttTid:u.sluttTid}),a(null))}return i?e.jsx(_,{}):e.jsx(pt,{visHistoriske:t,onToggleVisHistoriske:u=>{n(u),a(null)},bookinger:g,isPending:d,openKey:r,onToggleOpenKey:a,onAvbestill:l})}function ft(){const t=S();return K(["kommende-arrangementer",t],`/klubb/${t}/arrangement/kommende`,{requireAuth:!0,staleTime:3e4,select:n=>[...n].sort((r,a)=>r.startDato.localeCompare(a.startDato))})}function vt(t){const n=new Date(t),r=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate()),s=new Date(r.getFullYear(),r.getMonth(),r.getDate()),i=a.getTime()-s.getTime();return Math.max(0,Math.ceil(i/(1e3*60*60*24)))}function xt(t){return t.startDato===t.sluttDato?A(t.startDato):`${A(t.startDato)} – ${A(t.sluttDato)}`}function ht(t,n=45){const r=t.trim();return r.length<=n?r:`${r.slice(0,n).trimEnd()}…`}function H(t){return!t||t.length===0?"—":t.join(", ")}function jt({arrangementer:t}){const[n,r]=c.useState(null),a=c.useMemo(()=>new Set(t.map(s=>s.id)),[t]);return c.useEffect(()=>{n&&!a.has(n)&&r(null)},[n,a]),e.jsx(R,{title:"Kommende arrangementer",description:"Oversikt over arrangementer som er planlagt fremover.",children:t.length===0?e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Ingen arrangementer registrert."}):e.jsx("div",{className:"overflow-auto rounded-md border bg-background",children:e.jsxs(qe,{className:"text-sm",children:[e.jsx(He,{children:e.jsxs($,{children:[e.jsx(L,{children:"Hva"}),e.jsx(L,{className:"whitespace-nowrap",children:"Når"}),e.jsx(L,{className:"text-right whitespace-nowrap",children:"Om"})]})}),e.jsx(ze,{children:t.map(s=>{const i=vt(s.startDato),o=s.beskrivelse?.trim()??"",d=o.length>0,g=o.length>45,u=(s.baner?.length??0)>0||(s.ukedager?.length??0)>0||(s.tidspunkter?.length??0)>0||d&&g,p=n===s.id;return e.jsxs(c.Fragment,{children:[e.jsxs($,{className:x("hover:bg-muted/50",u&&"cursor-pointer"),onClick:()=>{u&&r(f=>f===s.id?null:s.id)},children:[e.jsx(C,{className:"align-top",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium",children:s.tittel}),d?e.jsx("div",{className:"text-xs text-muted-foreground",children:g?ht(o,45):o}):null]}),u?e.jsx(Xe,{className:x("mt-0.5 h-4 w-4 shrink-0 text-muted-foreground transition-transform",p&&"rotate-180")}):null]})}),e.jsx(C,{className:"align-top whitespace-nowrap",children:xt(s)}),e.jsxs(C,{className:"align-top text-right whitespace-nowrap text-muted-foreground",children:[i," ",i===1?"dag":"dager"]})]}),u&&p?e.jsx($,{children:e.jsx(C,{colSpan:3,className:"bg-muted/30",children:e.jsxs("div",{className:"space-y-3",children:[d?e.jsx("div",{className:"text-sm whitespace-pre-wrap break-words",children:o}):null,e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Baner"}),e.jsx("div",{className:"text-sm break-words",children:H(s.baner)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Ukedager"}),e.jsx("div",{className:"text-sm break-words",children:Qe(We(s.ukedager??[]))})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Tidspunkter"}),e.jsxs("div",{className:"text-sm break-words",children:[H(s.tidspunkter),s.slotLengdeMinutter?e.jsxs("span",{className:"text-muted-foreground",children:[" ","(",s.slotLengdeMinutter," min)"]}):null]})]})]})]})})}):null]},s.id)})})]})})})}function kt(){const{data:t=[],isLoading:n}=ft();return n?e.jsx(_,{}):e.jsx(jt,{arrangementer:t})}var J="AlertDialog",[bt,Cn]=G(J,[Y]),k=Y(),Z=t=>{const{__scopeAlertDialog:n,...r}=t,a=k(n);return e.jsx(Ze,{...a,...r,modal:!0})};Z.displayName=J;var yt="AlertDialogTrigger",ee=c.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...a}=t,s=k(r);return e.jsx(et,{...s,...a,ref:n})});ee.displayName=yt;var Nt="AlertDialogPortal",te=t=>{const{__scopeAlertDialog:n,...r}=t,a=k(n);return e.jsx(at,{...a,...r})};te.displayName=Nt;var At="AlertDialogOverlay",ne=c.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...a}=t,s=k(r);return e.jsx(ot,{...s,...a,ref:n})});ne.displayName=At;var D="AlertDialogContent",[Dt,Rt]=bt(D),wt=De("AlertDialogContent"),re=c.forwardRef((t,n)=>{const{__scopeAlertDialog:r,children:a,...s}=t,i=k(r),o=c.useRef(null),d=w(n,o),g=c.useRef(null);return e.jsx(tt,{contentName:D,titleName:se,docsSlug:"alert-dialog",children:e.jsx(Dt,{scope:r,cancelRef:g,children:e.jsxs(nt,{role:"alertdialog",...i,...s,ref:d,onOpenAutoFocus:E(s.onOpenAutoFocus,l=>{l.preventDefault(),g.current?.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[e.jsx(wt,{children:a}),e.jsx(Ct,{contentRef:o})]})})})});re.displayName=D;var se="AlertDialogTitle",ae=c.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...a}=t,s=k(r);return e.jsx(rt,{...s,...a,ref:n})});ae.displayName=se;var oe="AlertDialogDescription",ie=c.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...a}=t,s=k(r);return e.jsx(st,{...s,...a,ref:n})});ie.displayName=oe;var St="AlertDialogAction",le=c.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...a}=t,s=k(r);return e.jsx(X,{...s,...a,ref:n})});le.displayName=St;var ce="AlertDialogCancel",de=c.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...a}=t,{cancelRef:s}=Rt(ce,r),i=k(r),o=w(n,s);return e.jsx(X,{...i,...a,ref:o})});de.displayName=ce;var Ct=({contentRef:t})=>{const n=`\`${D}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${D}\` by passing a \`${oe}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${D}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return c.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(n)},[n,t]),null},Et=Z,Tt=ee,Pt=te,It=ne,_t=re,Mt=le,$t=de,Lt=ae,Vt=ie;function Ot({...t}){return e.jsx(Et,{"data-slot":"alert-dialog",...t})}function Bt({...t}){return e.jsx(Tt,{"data-slot":"alert-dialog-trigger",...t})}function Ft({...t}){return e.jsx(Pt,{"data-slot":"alert-dialog-portal",...t})}function Gt({className:t,...n}){return e.jsx(It,{"data-slot":"alert-dialog-overlay",className:x("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...n})}function Kt({className:t,...n}){return e.jsxs(Ft,{children:[e.jsx(Gt,{}),e.jsx(_t,{"data-slot":"alert-dialog-content",className:x("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n})]})}function Ut({className:t,...n}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:x("flex flex-col gap-2 text-center sm:text-left",t),...n})}function qt({className:t,...n}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:x("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...n})}function Ht({className:t,...n}){return e.jsx(Lt,{"data-slot":"alert-dialog-title",className:x("text-lg font-semibold",t),...n})}function zt({className:t,...n}){return e.jsx(Vt,{"data-slot":"alert-dialog-description",className:x("text-muted-foreground text-sm",t),...n})}function Qt({className:t,...n}){return e.jsx(Mt,{className:x(W(),t),...n})}function Wt({className:t,...n}){return e.jsx($t,{className:x(W({variant:"outline"}),t),...n})}function Yt({slettMeg:t,fullWidth:n=!1,disabled:r=!1,className:a}){const{signOut:s}=Me(),[i,o]=c.useState(!1),d=t.isPending,g=async()=>{try{await t.mutateAsync(),o(!1),await s()}catch{}};return e.jsxs(Ot,{open:i,onOpenChange:o,children:[e.jsx(Bt,{asChild:!0,children:e.jsx(O,{variant:"destructive",disabled:r||d,className:x(n&&"w-full",a),children:d?"Sletter...":"Slett min bruker"})}),e.jsxs(Kt,{children:[e.jsxs(Ut,{children:[e.jsx(Ht,{children:"Er du sikker?"}),e.jsx(zt,{children:"Dette vil slette din bruker og all tilknytning permanent. Denne handlingen kan ikke angres."})]}),e.jsxs(qt,{children:[e.jsx(Wt,{disabled:d,children:"Avbryt"}),e.jsx(Qt,{asChild:!0,children:e.jsx(O,{variant:"destructive",onClick:g,disabled:d,children:d?"Sletter...":"Slett bruker"})})]})]})]})}function ue(){const t=S(),n=K(["meg",t],`/klubb/${t}/bruker/meg`,{requireAuth:!0,staleTime:6e4}),r=V("patch",`/klubb/${t}/bruker/meg`,{onSuccess:()=>{j.success("Visningsnavn oppdatert"),n.refetch()},onError:i=>{j.error(i.message??"Kunne ikke oppdatere visningsnavn")}}),a=V("delete",`/klubb/${t}/bruker/meg`,{onSuccess:()=>j.success("Brukeren er slettet"),onError:i=>j.error(i.message??"Kunne ikke slette bruker")}),s=async()=>{try{const i=await $e.get(`/klubb/${t}/bruker/meg/egen-data`,{requireAuth:!0,responseType:"blob"}),o=i.data,g=i.headers?.["content-disposition"]?.match(/filename\*=UTF-8''([^;]+)|filename="?([^"]+)"?/i),u=decodeURIComponent(g?.[1]??g?.[2]??"")||`banebooking-data-${new Date().toISOString().slice(0,10)}.json`,p=URL.createObjectURL(o),f=document.createElement("a");f.href=p,f.download=u,document.body.appendChild(f),f.click(),f.remove(),URL.revokeObjectURL(p)}catch(i){const o=i instanceof Error?i.message:"Kunne ikke laste ned egen data";j.error(o)}};return{bruker:n.data,laster:n.isLoading,error:n.error,refetch:n.refetch,lastNedEgenData:s,oppdaterVisningsnavn:r,slettMeg:a}}var U="Radio",[Xt,ge]=G(U),[Jt,Zt]=Xt(U),pe=c.forwardRef((t,n)=>{const{__scopeRadio:r,name:a,checked:s=!1,required:i,disabled:o,value:d="on",onCheck:g,form:l,...u}=t,[p,f]=c.useState(null),m=w(n,b=>f(b)),v=c.useRef(!1),h=p?l||!!p.closest("form"):!0;return e.jsxs(Jt,{scope:r,checked:s,disabled:o,children:[e.jsx(I.button,{type:"button",role:"radio","aria-checked":s,"data-state":xe(s),"data-disabled":o?"":void 0,disabled:o,value:d,...u,ref:m,onClick:E(t.onClick,b=>{s||g?.(),h&&(v.current=b.isPropagationStopped(),v.current||b.stopPropagation())})}),h&&e.jsx(ve,{control:p,bubbles:!v.current,name:a,value:d,checked:s,required:i,disabled:o,form:l,style:{transform:"translateX(-100%)"}})]})});pe.displayName=U;var me="RadioIndicator",fe=c.forwardRef((t,n)=>{const{__scopeRadio:r,forceMount:a,...s}=t,i=Zt(me,r);return e.jsx(Ee,{present:a||i.checked,children:e.jsx(I.span,{"data-state":xe(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:n})})});fe.displayName=me;var en="RadioBubbleInput",ve=c.forwardRef(({__scopeRadio:t,control:n,checked:r,bubbles:a=!0,...s},i)=>{const o=c.useRef(null),d=w(o,i),g=it(r),l=Te(n);return c.useEffect(()=>{const u=o.current;if(!u)return;const p=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(p,"checked").set;if(g!==r&&m){const v=new Event("click",{bubbles:a});m.call(u,r),u.dispatchEvent(v)}},[g,r,a]),e.jsx(I.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:d,style:{...s.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ve.displayName=en;function xe(t){return t?"checked":"unchecked"}var tn=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],M="RadioGroup",[nn,En]=G(M,[Q,ge]),he=Q(),je=ge(),[rn,sn]=nn(M),ke=c.forwardRef((t,n)=>{const{__scopeRadioGroup:r,name:a,defaultValue:s,value:i,required:o=!1,disabled:d=!1,orientation:g,dir:l,loop:u=!0,onValueChange:p,...f}=t,m=he(r),v=Re(l),[h,b]=we({prop:i,defaultProp:s??null,onChange:p,caller:M});return e.jsx(rn,{scope:r,name:a,required:o,disabled:d,value:h,onValueChange:b,children:e.jsx(Se,{asChild:!0,...m,orientation:g,dir:v,loop:u,children:e.jsx(I.div,{role:"radiogroup","aria-required":o,"aria-orientation":g,"data-disabled":d?"":void 0,dir:v,...f,ref:n})})})});ke.displayName=M;var be="RadioGroupItem",ye=c.forwardRef((t,n)=>{const{__scopeRadioGroup:r,disabled:a,...s}=t,i=sn(be,r),o=i.disabled||a,d=he(r),g=je(r),l=c.useRef(null),u=w(n,l),p=i.value===s.value,f=c.useRef(!1);return c.useEffect(()=>{const m=h=>{tn.includes(h.key)&&(f.current=!0)},v=()=>f.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",v),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",v)}},[]),e.jsx(Ce,{asChild:!0,...d,focusable:!o,active:p,children:e.jsx(pe,{disabled:o,required:i.required,checked:p,...g,...s,name:i.name,ref:u,onCheck:()=>i.onValueChange(s.value),onKeyDown:E(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:E(s.onFocus,()=>{f.current&&l.current?.click()})})})});ye.displayName=be;var an="RadioGroupIndicator",Ne=c.forwardRef((t,n)=>{const{__scopeRadioGroup:r,...a}=t,s=je(r);return e.jsx(fe,{...s,...a,ref:n})});Ne.displayName=an;var on=ke,ln=ye,cn=Ne;function dn({className:t,...n}){return e.jsx(on,{"data-slot":"radio-group",className:x("grid gap-3",t),...n})}function z({className:t,...n}){return e.jsx(ln,{"data-slot":"radio-group-item",className:x("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:e.jsx(cn,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:e.jsx(Je,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}function un({epost:t,rollerText:n,mode:r,onSetMode:a,visningsnavn:s,onChangeVisningsnavn:i,maxLength:o,canSubmit:d,isSaving:g,error:l,onSubmit:u,deleteAction:p,isDeleteDisabled:f=!1}){return e.jsxs(Le,{density:"default",onSubmit:m=>{m.preventDefault(),u()},children:[e.jsxs(R,{title:"Innstillinger",description:"Velg hva som vises som navnet ditt i appen.",children:[e.jsx(T,{children:e.jsxs(P,{children:[e.jsx(N,{title:"Visningsnavn",description:"Velg e-post eller et eget navn.",children:e.jsxs(dn,{value:r,onValueChange:m=>a(m==="epost"?"epost":"navn"),className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{value:"epost",id:"visningsnavn-epost"}),e.jsxs(q,{htmlFor:"visningsnavn-epost",children:["E-post (",t,")"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{value:"navn",id:"visningsnavn-navn"}),e.jsx(q,{htmlFor:"visningsnavn-navn",children:"Eget navn"})]})]})}),r==="navn"?e.jsx(N,{children:e.jsxs(Ve,{"data-invalid":!!l,children:[e.jsx(Oe,{id:"visningsnavn",value:s,onChange:m=>i(m.target.value),placeholder:`F.eks. Ola Nordmann (maks ${o} tegn)`,maxLength:o,autoComplete:"name","aria-invalid":!!l}),l?e.jsx(Be,{children:l}):null]})}):null]})}),e.jsx(Fe,{align:"left",spaced:!1,className:"w-full mt-4",children:e.jsx(Ge,{isLoading:g,disabled:!d,fullWidth:!0,children:"Lagre endringer"})})]}),e.jsx(R,{title:"Konto",description:"Kontoinformasjon og tilgang. Enkelte opplysninger administreres av klubben.",children:e.jsx(T,{children:e.jsxs(P,{children:[e.jsx(B,{label:"Brukernavn / ID",value:t}),e.jsx(B,{label:"Tilgang",value:n}),e.jsx(N,{title:"Slett min bruker",description:"Sletter bruker og all tilknyttet data permanent.",right:e.jsx("div",{className:f?"pointer-events-none opacity-60":"",children:p})})]})})})]})}const F=50,gn=/^[\p{L}\d\s.@'_%+-]{3,}$/u;function pn(t){const n=t.trim();return n.length===0?"Visningsnavn kan ikke være tomt.":n.length<3?"Visningsnavn må være minst 3 tegn.":gn.test(n)?n.length>F?`Visningsnavn kan ikke være lengre enn ${F} tegn.`:null:"Visningsnavn inneholder ugyldige tegn."}function mn(){const{bruker:t,laster:n,oppdaterVisningsnavn:r,slettMeg:a}=ue(),{mutateAsync:s,isPending:i}=r,[o,d]=c.useState("epost"),[g,l]=c.useState(""),[u,p]=c.useState(null);if(c.useEffect(()=>{if(!t)return;const y=t.visningsnavn?.trim();!y||y===t.epost?(d("epost"),l("")):(d("navn"),l(y)),p(null)},[t]),n||!t)return e.jsx(_,{});const f=o==="epost"?t.epost:g.trim(),m=(t.visningsnavn??"").trim(),v=f,h=o==="navn"?pn(g):null,b=v.length>0&&v!==m&&(o==="epost"||!h);async function Ae(){p(h),!h&&await s({visningsnavn:f})}return e.jsx(un,{epost:t.epost,rollerText:t.roller.join(", "),mode:o,onSetMode:y=>{d(y),p(null)},visningsnavn:g,onChangeVisningsnavn:y=>{l(y),u&&p(null)},maxLength:F,error:u,canSubmit:b,isSaving:i,onSubmit:()=>void Ae(),deleteAction:e.jsx(Yt,{slettMeg:a}),isDeleteDisabled:i})}function fn(){const t=S(),{bruker:n,laster:r,lastNedEgenData:a,slettMeg:s}=ue(),[i,o]=c.useState(!1);if(r||!n)return e.jsx(_,{});const d=n.vilkaarAkseptertDato?`Akseptert ${A(n.vilkaarAkseptertDato)}${n.vilkaarVersjon?` (versjon ${n.vilkaarVersjon})`:""}`:"Ikke registrert",g=async()=>{if(!i)try{o(!0),await a()}catch(l){const u=l instanceof Error?l.message:"Kunne ikke laste ned egen data";j.error(u)}finally{o(!1)}};return e.jsx("div",{children:e.jsx(R,{title:"Persondata",description:"Her kan du se vilkår og laste ned egne data.",children:e.jsx(T,{children:e.jsxs(P,{children:[e.jsx(B,{label:"Vilkår",description:"Vilkårene aksepteres automatisk ved første innlogging.",value:d}),e.jsx(N,{title:"Les vilkårene",description:"Åpnes i ny fane.",right:e.jsx(Ke,{to:`/${t}/vilkaar`,className:"text-sm underline text-primary hover:text-primary/80",target:"_blank",rel:"noopener noreferrer",children:"Åpne"})}),e.jsx(N,{title:"Last ned dine data",description:"JSON med registrerte opplysninger og bookinger.",right:e.jsx(O,{onClick:g,size:"sm",variant:"outline",disabled:i||s.isPending,children:i?"Laster...":"Last ned"})})]})})})})}function Tn(){return e.jsx(Pe,{children:e.jsx(Ie,{defaultValue:"bookinger",items:[{value:"bookinger",label:"Bookinger",content:e.jsx(mt,{})},{value:"kommende-arrangementer",label:"Arrangement",content:e.jsx(kt,{})},{value:"profil",label:"Profil",content:e.jsx(mn,{})},{value:"persondata",label:"Data",content:e.jsx(fn,{})}]})})}export{Tn as default};
