import{j as a,r as b}from"./shadcn-DPSgmxN6.js";import{e as x,d as v,g as f,L as R,B as h,t as k,o as j}from"./index-BYC8jElZ.js";import{C as F,a as S}from"./card-Bt8C29rJ.js";import{F as d}from"./FormField-rCnNSN9O.js";import{F as c}from"./FieldWrapper-DqorA9eC.js";import{S as C}from"./SelectField-BxiLzjVq.js";import"./react-RGnvvjkK.js";import"./lucide-Uxrg_z7G.js";import"./index-DUAXFcx0.js";function T({className:r,...n}){return a.jsx("textarea",{"data-slot":"textarea",className:x("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),...n})}function E({id:r,label:n,value:s,onChange:l,helpText:i,error:o}){return a.jsx(c,{id:r,label:n,helpText:i,error:o,children:a.jsx(T,{id:r,value:s,onChange:l,className:o?"border-destructive":""})})}function u({id:r,label:n,value:s,onChange:l,min:i=0,max:o=10,step:g=1,helpText:m,error:t}){return a.jsx(c,{id:r,label:`${n}: ${s}`,helpText:m,error:t,children:a.jsx("input",{id:r,type:"range",value:s,min:i,max:o,step:g,onChange:e=>l(parseInt(e.target.value)),className:"w-full"})})}function B(){const{slug:r}=v(),{klubb:n,laster:s}=f(r),[l,i]=b.useState({navn:"",kontaktEpost:"",banereglement:"",latitude:"",longitude:"",feedUrl:"",bookingRegel:{maksPerDag:1,maksTotalt:2,dagerFremITid:7,slotLengdeMinutter:60,aapningstid:"07:00",stengetid:"22:00"}}),[o,g]=b.useState(!1);b.useEffect(()=>{n&&i({navn:n.navn,kontaktEpost:n.kontaktEpost??"",banereglement:n.banereglement??"",latitude:n.latitude?.toString()??"",longitude:n.longitude?.toString()??"",feedUrl:n.feedUrl??"",bookingRegel:{maksPerDag:n.bookingRegel?.maksPerDag??1,maksTotalt:n.bookingRegel?.maksTotalt??2,dagerFremITid:n.bookingRegel?.dagerFremITid??7,slotLengdeMinutter:n.bookingRegel?.slotLengdeMinutter??60,aapningstid:n.bookingRegel?.aapningstid??"07:00",stengetid:n.bookingRegel?.stengetid??"22:00"}})},[n]);async function m(t){t.preventDefault(),g(!0);const e={...l};if(e.bookingRegel.maksTotalt<e.bookingRegel.maksPerDag){k.error("Totalt antall bookinger kan ikke være lavere enn maks per dag."),g(!1);return}try{await j(r,{navn:e.navn,kontaktEpost:e.kontaktEpost,banereglement:e.banereglement,latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude),feedUrl:e.feedUrl,bookingRegel:{...e.bookingRegel}}),k.success("Endringer lagret")}catch(p){k.error(p instanceof Error?p.message:"Ukjent feil")}g(!1)}return s?a.jsx(R,{}):n?a.jsx("div",{className:"max-w-screen-sm mx-auto px-2 py-2",children:a.jsx("form",{onSubmit:m,className:"space-y-4",children:a.jsx(F,{children:a.jsxs(S,{className:"p-4 space-y-4",children:[a.jsx(d,{id:"navn",label:"Navn",value:l.navn,onChange:t=>i(e=>({...e,navn:t.target.value}))}),a.jsx(d,{id:"kontaktEpost",label:"Kontakt-e-post",type:"email",value:l.kontaktEpost,onChange:t=>i(e=>({...e,kontaktEpost:t.target.value}))}),a.jsx(E,{id:"banereglement",label:"Banereglement",value:l.banereglement,onChange:t=>i(e=>({...e,banereglement:t.target.value}))}),a.jsx(d,{id:"latitude",label:"Latitude",value:l.latitude,onChange:t=>i(e=>({...e,latitude:t.target.value}))}),a.jsx(d,{id:"longitude",label:"Longitude",value:l.longitude,onChange:t=>i(e=>({...e,longitude:t.target.value}))}),a.jsx(d,{id:"feedUrl",label:"RSS-feed (valgfritt)",value:l.feedUrl,onChange:t=>i(e=>({...e,feedUrl:t.target.value}))}),a.jsxs("div",{className:"space-y-3 pt-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Bookingregler"}),a.jsx(u,{id:"aapningstid",label:"Åpningstid",value:parseInt(l.bookingRegel.aapningstid.split(":")[0]),onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,aapningstid:`${t.toString().padStart(2,"0")}:00`}})),min:6,max:23}),a.jsx(u,{id:"stengetid",label:"Stengetid",value:parseInt(l.bookingRegel.stengetid.split(":")[0]),onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,stengetid:`${t.toString().padStart(2,"0")}:00`}})),min:6,max:23}),a.jsx(u,{id:"maksPerDag",label:"Maks bookinger per dag",value:l.bookingRegel.maksPerDag,onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,maksPerDag:t}})),min:0,max:5}),a.jsx(u,{id:"maksTotalt",label:"Maks aktive bookinger totalt",value:l.bookingRegel.maksTotalt,onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,maksTotalt:t}})),min:0,max:10}),a.jsx(u,{id:"dagerFremITid",label:"Dager frem i tid tillatt",value:l.bookingRegel.dagerFremITid,onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,dagerFremITid:t}})),min:1,max:14}),a.jsx(C,{id:"slotLengdeMinutter",label:"Slot-lengde (minutter)",value:l.bookingRegel.slotLengdeMinutter.toString(),onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,slotLengdeMinutter:parseInt(t)}})),options:[{label:"30 minutter",value:"30"},{label:"45 minutter",value:"45"},{label:"60 minutter",value:"60"},{label:"90 minutter",value:"90"}],disabled:!0})]}),a.jsx("div",{className:"pt-2",children:a.jsx(h,{type:"submit",size:"sm",disabled:o,children:o?"Lagrer...":"Lagre endringer"})})]})})})}):a.jsx("p",{className:"text-sm text-destructive px-2 py-2 text-center",children:"Fant ikke klubb."})}export{B as default};
