import{r as o,j as n}from"./shadcn-mOdBhBu9.js";import{P as B}from"./Page-DGRPpX6y.js";import{S as N}from"./SimpleTabsLazy-HWGk_Ewh.js";import{u as x}from"./useBaner-Dh0Ak8Hz.js";import{F as g,B as k}from"./index-CYoHqIT9.js";import{S as L}from"./SelectField-DleYtHuW.js";import{S as C}from"./SwitchRow-Chp0owzM.js";import{S as j}from"./SettingsSection-DgasYiYd.js";import"./react-RGnvvjkK.js";import"./lucide-ByENZzyU.js";import"./index-Bb2dXpgu.js";import"./switch-rJg2FX1a.js";const p="rediger.valgtBaneId";function E(){const{baner:i,isLoading:l,oppdaterBane:d}=x(!0),[c,u]=o.useState({}),[t,s]=o.useState(()=>{const e=sessionStorage.getItem(p);return e&&e!=="null"?e:null}),a=i.find(e=>e.id===t)??null,r=t?c[t]??null:null;o.useEffect(()=>{sessionStorage.setItem(p,t??"null")},[t]),o.useEffect(()=>{t&&!i.some(e=>e.id===t)&&s(null)},[i,t]),o.useEffect(()=>{!t&&i.length>0&&s(i[0].id)},[i,t]);function m(e,f,v){u(b=>({...b,[e]:{...b[e]??i.find(S=>S.id===e),[f]:v}}))}async function h(){if(!t)return;const e=c[t];if(e)try{await d.mutateAsync({id:t,dto:e}),u(f=>{const v={...f};return delete v[t],v})}catch{}}const y=!!a&&!!r&&!(r.navn===a.navn&&r.beskrivelse===a.beskrivelse&&r.aktiv===a.aktiv);return l?n.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Laster..."}):n.jsx(j,{title:"Rediger bane",description:"Velg en bane og oppdater informasjon.",children:n.jsxs("form",{className:"space-y-4",onSubmit:e=>{e.preventDefault(),h()},children:[n.jsx(L,{id:"velg-bane",label:"Velg bane",value:t??"",onChange:e=>s(e||null),options:i.map(e=>({label:`${e.navn} ${e.aktiv?"":"(inaktiv)"}`,value:e.id}))}),a?n.jsxs(n.Fragment,{children:[n.jsx(g,{id:"navn",label:"Navn",value:r?.navn??a.navn,onChange:e=>m(a.id,"navn",e.target.value)}),n.jsx(g,{id:"beskrivelse",label:"Beskrivelse",value:r?.beskrivelse??a.beskrivelse,onChange:e=>m(a.id,"beskrivelse",e.target.value)}),n.jsx(C,{title:"Aktiv",description:"Avgjør om banen er tilgjengelig for booking.",checked:r?.aktiv??a.aktiv,onCheckedChange:e=>m(a.id,"aktiv",e)}),n.jsx("div",{className:"flex justify-end",children:n.jsx(k,{size:"sm",type:"submit",disabled:!y||d.isPending,children:d.isPending?"Lagrer...":"Lagre"})})]}):n.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Ingen baner funnet."})]})})}function P(){const{opprettBane:i}=x(),[l,d]=o.useState({navn:"",beskrivelse:""}),[c,u]=o.useState(null);async function t(){const s=l.navn.trim();if(!s){u("Navn er påkrevd.");return}u(null);try{await i.mutateAsync({...l,navn:s}),d({navn:"",beskrivelse:""})}catch{}}return n.jsx(j,{title:"Ny bane",description:"Legg til en ny bane i klubben.",children:n.jsxs("form",{className:"space-y-3",onSubmit:s=>{s.preventDefault(),t()},children:[n.jsx(g,{id:"ny-navn",label:"Navn",value:l.navn,error:c,onChange:s=>{const a=s.target.value;d(r=>({...r,navn:a})),c&&a.trim()&&u(null)}}),n.jsx(g,{id:"ny-beskrivelse",label:"Beskrivelse",value:l.beskrivelse,onChange:s=>d(a=>({...a,beskrivelse:s.target.value}))}),n.jsx(k,{size:"sm",type:"submit",disabled:i.isPending,children:i.isPending?"Legger til...":"Legg til"})]})})}function O(){const[i,l]=o.useState("rediger");return n.jsx(B,{children:n.jsx(N,{items:[{value:"rediger",label:"Rediger bane",content:n.jsx(E,{})},{value:"ny",label:"Ny bane",content:n.jsx(P,{})}],value:i,onValueChange:l})})}export{O as default};
