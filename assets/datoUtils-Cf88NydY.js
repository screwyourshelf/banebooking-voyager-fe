import{r as c,j as i}from"./shadcn-BfUXmlP3.js";import{f as p,g as D,t as f,e as l}from"./index-CZ7yxNIj.js";import{u as F}from"./useBaner-BRpSQ6Fy.js";async function j(t){return await(await p(`/api/klubb/${t}/arrangement/kommende`)).json()}async function M(t,e){return await(await p(`/api/klubb/${t}/arrangement/forhandsvis`,{method:"POST",body:JSON.stringify(e)},!0)).json()}async function N(t,e){return await(await p(`/api/klubb/${t}/arrangement`,{method:"POST",body:JSON.stringify(e)},!0)).json()}function T(t){const[e,a]=t.split(":").map(Number);return e*60+a}function L(t){const e=String(Math.floor(t/60)).padStart(2,"0"),a=String(t%60).padStart(2,"0");return`${e}:${a}`}function A(t,e,a){const o=T(t),u=T(e),n=[];for(let r=o;r+a<=u;r+=a)n.push(L(r));return n}function W(t){const{klubb:e,laster:a}=D(t),{baner:o,isLoading:u}=F(),[n,r]=c.useState(!1),[m,g]=c.useState(!1),[S,h]=c.useState({ledige:[],konflikter:[]}),[k,w]=c.useState([]),x=c.useMemo(()=>{if(!(e!=null&&e.bookingRegel))return[];const d=e.bookingRegel.aapningstid||"08:00",s=e.bookingRegel.stengetid||"22:00",y=e.bookingRegel.slotLengdeMinutter||60;return A(d,s,y)},[e]),b=async()=>{if(t){r(!0);try{const s=(await j(t)).sort((y,v)=>y.startDato.localeCompare(v.startDato));w(s)}catch{f.error("Feil ved henting av arrangementer")}finally{r(!1)}}};return c.useEffect(()=>{b()},[t]),{klubb:e,baner:o,isLoading:a||u||n,isLoadingForhandsvisning:m,tilgjengeligeTidspunkter:x,forhandsvisning:S,setForhandsvisning:h,forhandsvis:async d=>{if(t){g(!0);try{const s=await M(t,d);return h(s),{success:!0}}catch{return f.error("Feil ved forhåndsvisning"),{success:!1}}finally{g(!1)}}},opprett:async d=>{if(t){g(!0);try{const s=await N(t,d);return h({ledige:[],konflikter:[]}),f.success(`${s.opprettet.length} bookinger opprettet`),await b(),{success:!0,result:s}}catch{return f.error("Feil ved oppretting"),{success:!1}}finally{g(!1)}}},arrangementer:k,lastArrangementer:b}}function I({className:t,...e}){return i.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:i.jsx("table",{"data-slot":"table",className:l("w-full caption-bottom text-sm",t),...e})})}function P({className:t,...e}){return i.jsx("thead",{"data-slot":"table-header",className:l("[&_tr]:border-b",t),...e})}function U({className:t,...e}){return i.jsx("tbody",{"data-slot":"table-body",className:l("[&_tr:last-child]:border-0",t),...e})}function Y({className:t,...e}){return i.jsx("tr",{"data-slot":"table-row",className:l("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...e})}function C({className:t,...e}){return i.jsx("th",{"data-slot":"table-head",className:l("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...e})}function H({className:t,...e}){return i.jsx("td",{"data-slot":"table-cell",className:l("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...e})}const J=["Man","Tir","Ons","Tor","Fre","Lør","Søn"],_={Man:"Monday",Tir:"Tuesday",Ons:"Wednesday",Tor:"Thursday",Fre:"Friday",Lør:"Saturday",Søn:"Sunday"},q={Monday:"Man",Tuesday:"Tir",Wednesday:"Ons",Thursday:"Tor",Friday:"Fre",Saturday:"Lør",Sunday:"Søn"},$={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"};function z(t){const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${o}`}function G(t,e){const a=new Set,o=new Date(t.getFullYear(),t.getMonth(),t.getDate()),u=new Date(e.getFullYear(),e.getMonth(),e.getDate());for(let n=new Date(o);n<=u;n.setDate(n.getDate()+1)){const r=n.getDay(),m=$[r];a.add(m)}return a}function Q(t){return new Date(t).toLocaleDateString("nb-NO",{day:"2-digit",month:"2-digit",year:"numeric"})}export{I as T,P as a,Y as b,C as c,U as d,H as e,Q as f,J as g,q as h,$ as i,G as j,_ as k,z as t,W as u};
