import{r as m,j as n}from"./shadcn-mOdBhBu9.js";import{P as T}from"./Page-BAUDoBUs.js";import{S as D}from"./SimpleTabsLazy-BxVfxetN.js";import{d as j,L as S,B as y}from"./index-BmpR0lIy.js";import{S as k}from"./SettingsSection-BMJxH0WA.js";import{a as h,S as g}from"./SettingsRow-SsVQpD69.js";import{S as c}from"./SettingsInput-CuF3KRfa.js";import{S as M}from"./SelectField-KSdPefzM.js";import"./react-RGnvvjkK.js";import"./lucide-ByENZzyU.js";import"./index-Bb2dXpgu.js";function L(){const{data:e,isLoading:l,oppdaterKlubb:u}=j(),[t,s]=m.useState({navn:"",kontaktEpost:"",banereglement:"",latitude:"",longitude:"",feedUrl:"",feedSynligAntallDager:""});m.useEffect(()=>{e&&s({navn:e.navn??"",kontaktEpost:e.kontaktEpost??"",banereglement:e.banereglement??"",latitude:e.latitude?.toString()??"",longitude:e.longitude?.toString()??"",feedUrl:e.feedUrl??"",feedSynligAntallDager:(e.feedSynligAntallDager??50).toString()})},[e]);const d=m.useMemo(()=>e?(t.navn??"")!==(e.navn??"")||(t.kontaktEpost??"")!==(e.kontaktEpost??"")||(t.banereglement??"")!==(e.banereglement??"")||(t.latitude??"")!==(e.latitude?.toString()??"")||(t.longitude??"")!==(e.longitude?.toString()??"")||(t.feedUrl??"")!==(e.feedUrl??"")||(t.feedSynligAntallDager??"")!==(e.feedSynligAntallDager??50).toString():!1,[e,t]);if(l||!e)return n.jsx(S,{});function o(a){const i=a.trim();if(!i)return;const r=Number(i.replace(",","."));return Number.isFinite(r)?r:void 0}return n.jsxs("form",{className:"space-y-4",onSubmit:a=>{a.preventDefault();const i=o(t.latitude),r=o(t.longitude),p=o(t.feedSynligAntallDager);u.mutate({...e,navn:t.navn,kontaktEpost:t.kontaktEpost,banereglement:t.banereglement,latitude:i??e.latitude??null,longitude:r??e.longitude??null,feedUrl:t.feedUrl,feedSynligAntallDager:p??e.feedSynligAntallDager??50})},children:[n.jsx(k,{title:"Grunninfo",description:"Informasjon som vises utad i Banebooking.",children:n.jsxs(h,{children:[n.jsx(g,{title:"Klubbnavn",description:"Navnet på klubben slik det vises utad i Banebooking.",children:n.jsx(c,{value:t.navn,onChange:a=>s(i=>({...i,navn:a})),placeholder:"Ås tennisklubb",autoComplete:"organization"})}),n.jsx(g,{title:"Kontakt-e-post",description:"Vises på klubbens infoside. Brukes til henvendelser fra medlemmer og gjester.",children:n.jsx(c,{value:t.kontaktEpost,onChange:a=>s(i=>({...i,kontaktEpost:a})),placeholder:"post@klubb.no",type:"email",inputMode:"email",autoComplete:"email"})})]})}),n.jsx(k,{title:"Kart",description:"Valgfrie innstillinger for innhenting av værinformasjon.",children:n.jsxs(h,{children:[n.jsx(g,{title:"Latitude (breddegrad)",description:"",children:n.jsx(c,{value:t.latitude,onChange:a=>s(i=>({...i,latitude:a})),placeholder:"f.eks. 59.6552",inputMode:"decimal"})}),n.jsx(g,{title:"Longitude (lengdegrad)",description:"",children:n.jsx(c,{value:t.longitude,onChange:a=>s(i=>({...i,longitude:a})),placeholder:"f.eks. 10.7769",inputMode:"decimal"})})]})}),n.jsx(k,{title:"Feed",description:"Valgfrie innstillinger for innhenting nyheter fra klubbens RSS-feed.",children:n.jsxs(h,{children:[n.jsx(g,{title:"RSS-feed",description:"URL til klubbens RSS-feed (f.eks. nyheter). Hvis satt, hentes og vises de nyeste innleggene i appen.",children:n.jsx(c,{value:t.feedUrl,onChange:a=>s(i=>({...i,feedUrl:a})),placeholder:"https://www.aastk.no/?feed=rss2",inputMode:"url",type:"url"})}),n.jsx(g,{title:"Aldergrense for feedinnslag (dager)",description:"Hvor mange dager gamle innslag som vises. Sett til 0 for å inkludere alle.",children:n.jsx(c,{value:t.feedSynligAntallDager,onChange:a=>s(i=>({...i,feedSynligAntallDager:a})),type:"number",inputMode:"numeric",min:0,step:1})})]})}),n.jsx("div",{className:"flex justify-end",children:n.jsx(y,{type:"submit",size:"sm",disabled:!d||u.isPending,children:u.isPending?"Lagrer...":"Lagre endringer"})})]})}function b({id:e,value:l,onChange:u,min:t=0,max:s=10,step:d=1,disabled:o=!1}){return n.jsx("input",{id:e,type:"range",value:l,min:t,max:s,step:d,disabled:o,onChange:a=>u(parseInt(a.target.value,10)),className:"w-full"})}function R({title:e,description:l,id:u,value:t,onChange:s,options:d,disabled:o,className:a}){return n.jsx(g,{title:e,description:l,className:a,children:n.jsx(M,{id:u,label:e,hideLabel:!0,value:t,onChange:s,options:d,disabled:o})})}function v(e){const l=parseInt((e??"").split(":")[0]??"0",10);return Number.isFinite(l)?l:0}function f(e){return`${String(e).padStart(2,"0")}:00`}function C(){const{data:e,isLoading:l,oppdaterKlubb:u}=j(),[t,s]=m.useState({maksPerDag:1,maksTotalt:2,dagerFremITid:7,slotLengdeMinutter:60,aapningstid:"07:00",stengetid:"22:00"});m.useEffect(()=>{e?.bookingRegel&&s({maksPerDag:e.bookingRegel.maksPerDag??1,maksTotalt:e.bookingRegel.maksTotalt??2,dagerFremITid:e.bookingRegel.dagerFremITid??7,slotLengdeMinutter:e.bookingRegel.slotLengdeMinutter??60,aapningstid:e.bookingRegel.aapningstid??"07:00",stengetid:e.bookingRegel.stengetid??"22:00"})},[e]);const d=m.useMemo(()=>v(t.aapningstid),[t.aapningstid]),o=m.useMemo(()=>v(t.stengetid),[t.stengetid]);m.useEffect(()=>{if(d>=o){const i=Math.min(23,d+1);s(r=>({...r,stengetid:f(i)}))}},[d,o]);const a=m.useMemo(()=>{if(!e?.bookingRegel)return!1;const i=e.bookingRegel;return t.maksPerDag!==(i.maksPerDag??1)||t.maksTotalt!==(i.maksTotalt??2)||t.dagerFremITid!==(i.dagerFremITid??7)||t.slotLengdeMinutter!==(i.slotLengdeMinutter??60)||t.aapningstid!==(i.aapningstid??"07:00")||t.stengetid!==(i.stengetid??"22:00")},[e,t]);return l||!e?n.jsx(S,{}):n.jsxs("form",{className:"space-y-4",onSubmit:i=>{i.preventDefault(),u.mutate({navn:e.navn??"",kontaktEpost:e.kontaktEpost??"",banereglement:e.banereglement??"",latitude:e.latitude??null,longitude:e.longitude??null,feedUrl:e.feedUrl??null,feedSynligAntallDager:e.feedSynligAntallDager??7,bookingRegel:t})},children:[n.jsx(k,{title:"Bookinginnstillinger",description:"Styr åpningstider, hvor mange bookinger som er lov, og hvor langt frem man kan booke.",children:n.jsxs(h,{children:[n.jsx(g,{title:"Åpningstid",description:"Tidligste time det går an å booke.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:d}),children:n.jsx(b,{id:"aapningstid",value:d,min:6,max:23,onChange:i=>{const r=i,p=Math.max(o,r+1);s(x=>({...x,aapningstid:f(r),stengetid:f(Math.min(23,p))}))}})}),n.jsx(g,{title:"Stengetid",description:"Siste time som kan startes.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:o}),children:n.jsx(b,{id:"stengetid",value:o,min:6,max:23,onChange:i=>{const r=i,p=Math.min(d,r-1);s(x=>({...x,aapningstid:f(Math.max(6,p)),stengetid:f(r)}))}})}),n.jsx(g,{title:"Maks bookinger per dag",description:"Begrenser hvor mange bookinger én bruker kan ha på samme dag.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:t.maksPerDag}),children:n.jsx(b,{id:"maksPerDag",value:t.maksPerDag,min:0,max:5,onChange:i=>s(r=>({...r,maksPerDag:i}))})}),n.jsx(g,{title:"Maks aktive bookinger totalt",description:"Begrenser hvor mange aktive bookinger en bruker kan ha samtidig.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:t.maksTotalt}),children:n.jsx(b,{id:"maksTotalt",value:t.maksTotalt,min:0,max:10,onChange:i=>s(r=>({...r,maksTotalt:i}))})}),n.jsx(g,{title:"Dager frem i tid",description:"Hvor mange dager frem i tid det er mulig å booke.",right:n.jsx("div",{className:"text-sm font-medium tabular-nums",children:t.dagerFremITid}),children:n.jsx(b,{id:"dagerFremITid",value:t.dagerFremITid,min:1,max:14,onChange:i=>s(r=>({...r,dagerFremITid:i}))})}),n.jsx(R,{title:"Slot-lengde",description:"Hvor lange booking-slottene er (låst i denne versjonen).",id:"slotLengdeMinutter",value:t.slotLengdeMinutter.toString(),onChange:i=>s(r=>({...r,slotLengdeMinutter:parseInt(i,10)})),options:[{label:"30 minutter",value:"30"},{label:"45 minutter",value:"45"},{label:"60 minutter",value:"60"},{label:"90 minutter",value:"90"}],disabled:!0})]})}),n.jsx("div",{className:"flex justify-end",children:n.jsx(y,{type:"submit",size:"sm",disabled:!a||u.isPending,children:u.isPending?"Lagrer...":"Lagre endringer"})})]})}function z(){const[e,l]=m.useState("info");return n.jsx(T,{children:n.jsx(D,{items:[{value:"info",label:"Klubbinnstillinger",content:n.jsx(L,{})},{value:"booking",label:"Bookinginnstillinger",content:n.jsx(C,{})}],value:e,onValueChange:l})})}export{z as default};
