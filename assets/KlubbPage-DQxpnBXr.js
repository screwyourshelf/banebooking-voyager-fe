import{j as a,r as k}from"./shadcn-V64FgQuT.js";import{e as j,d as F,g as S,L as C,B as T,t as p,o as E}from"./index-BpRXuvrW.js";import{C as L,a as y}from"./card-BSIkFMgF.js";import{F as u}from"./FormField-DMvD_Qa2.js";import{F as h}from"./FieldWrapper-CZxtpqPX.js";import{S as N}from"./SelectField-CSP2YQsO.js";import"./react-D5d5vywP.js";import"./lucide-VYBZz5NY.js";import"./index-uoXEFuNP.js";function I({className:r,...n}){return a.jsx("textarea",{"data-slot":"textarea",className:j("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),...n})}function D({id:r,label:n,value:s,onChange:l,helpText:i,error:o}){return a.jsx(h,{id:r,label:n,helpText:i,error:o,children:a.jsx(I,{id:r,value:s,onChange:l,className:o?"border-destructive":""})})}function m({id:r,label:n,value:s,onChange:l,min:i=0,max:o=10,step:g=1,helpText:b,error:t}){return a.jsx(h,{id:r,label:`${n}: ${s}`,helpText:b,error:t,children:a.jsx("input",{id:r,type:"range",value:s,min:i,max:o,step:g,onChange:e=>l(parseInt(e.target.value)),className:"w-full"})})}function q(){const{slug:r}=F(),{klubb:n,laster:s}=S(r),[l,i]=k.useState({navn:"",kontaktEpost:"",banereglement:"",latitude:"",longitude:"",feedUrl:"",bookingRegel:{maksPerDag:1,maksTotalt:2,dagerFremITid:7,slotLengdeMinutter:60,aapningstid:"07:00",stengetid:"22:00"}}),[o,g]=k.useState(!1);k.useEffect(()=>{var t,e,d,c,x,v,f,R;n&&i({navn:n.navn,kontaktEpost:n.kontaktEpost??"",banereglement:n.banereglement??"",latitude:((t=n.latitude)==null?void 0:t.toString())??"",longitude:((e=n.longitude)==null?void 0:e.toString())??"",feedUrl:n.feedUrl??"",bookingRegel:{maksPerDag:((d=n.bookingRegel)==null?void 0:d.maksPerDag)??1,maksTotalt:((c=n.bookingRegel)==null?void 0:c.maksTotalt)??2,dagerFremITid:((x=n.bookingRegel)==null?void 0:x.dagerFremITid)??7,slotLengdeMinutter:((v=n.bookingRegel)==null?void 0:v.slotLengdeMinutter)??60,aapningstid:((f=n.bookingRegel)==null?void 0:f.aapningstid)??"07:00",stengetid:((R=n.bookingRegel)==null?void 0:R.stengetid)??"22:00"}})},[n]);async function b(t){t.preventDefault(),g(!0);const e={...l};if(e.bookingRegel.maksTotalt<e.bookingRegel.maksPerDag){p.error("Totalt antall bookinger kan ikke være lavere enn maks per dag."),g(!1);return}try{await E(r,{navn:e.navn,kontaktEpost:e.kontaktEpost,banereglement:e.banereglement,latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude),feedUrl:e.feedUrl,bookingRegel:{...e.bookingRegel}}),p.success("Endringer lagret")}catch(d){p.error(d instanceof Error?d.message:"Ukjent feil")}g(!1)}return s?a.jsx(C,{}):n?a.jsx("div",{className:"max-w-screen-sm mx-auto px-2 py-2",children:a.jsx("form",{onSubmit:b,className:"space-y-4",children:a.jsx(L,{children:a.jsxs(y,{className:"p-4 space-y-4",children:[a.jsx(u,{id:"navn",label:"Navn",value:l.navn,onChange:t=>i(e=>({...e,navn:t.target.value}))}),a.jsx(u,{id:"kontaktEpost",label:"Kontakt-e-post",type:"email",value:l.kontaktEpost,onChange:t=>i(e=>({...e,kontaktEpost:t.target.value}))}),a.jsx(D,{id:"banereglement",label:"Banereglement",value:l.banereglement,onChange:t=>i(e=>({...e,banereglement:t.target.value}))}),a.jsx(u,{id:"latitude",label:"Latitude",value:l.latitude,onChange:t=>i(e=>({...e,latitude:t.target.value}))}),a.jsx(u,{id:"longitude",label:"Longitude",value:l.longitude,onChange:t=>i(e=>({...e,longitude:t.target.value}))}),a.jsx(u,{id:"feedUrl",label:"RSS-feed (valgfritt)",value:l.feedUrl,onChange:t=>i(e=>({...e,feedUrl:t.target.value}))}),a.jsxs("div",{className:"space-y-3 pt-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Bookingregler"}),a.jsx(m,{id:"aapningstid",label:"Åpningstid",value:parseInt(l.bookingRegel.aapningstid.split(":")[0]),onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,aapningstid:`${t.toString().padStart(2,"0")}:00`}})),min:6,max:23}),a.jsx(m,{id:"stengetid",label:"Stengetid",value:parseInt(l.bookingRegel.stengetid.split(":")[0]),onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,stengetid:`${t.toString().padStart(2,"0")}:00`}})),min:6,max:23}),a.jsx(m,{id:"maksPerDag",label:"Maks bookinger per dag",value:l.bookingRegel.maksPerDag,onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,maksPerDag:t}})),min:0,max:5}),a.jsx(m,{id:"maksTotalt",label:"Maks aktive bookinger totalt",value:l.bookingRegel.maksTotalt,onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,maksTotalt:t}})),min:0,max:10}),a.jsx(m,{id:"dagerFremITid",label:"Dager frem i tid tillatt",value:l.bookingRegel.dagerFremITid,onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,dagerFremITid:t}})),min:1,max:14}),a.jsx(N,{id:"slotLengdeMinutter",label:"Slot-lengde (minutter)",value:l.bookingRegel.slotLengdeMinutter.toString(),onChange:t=>i(e=>({...e,bookingRegel:{...e.bookingRegel,slotLengdeMinutter:parseInt(t)}})),options:[{label:"30 minutter",value:"30"},{label:"45 minutter",value:"45"},{label:"60 minutter",value:"60"},{label:"90 minutter",value:"90"}],disabled:!0})]}),a.jsx("div",{className:"pt-2",children:a.jsx(T,{type:"submit",size:"sm",disabled:o,children:o?"Lagrer...":"Lagre endringer"})})]})})})}):a.jsx("p",{className:"text-sm text-destructive px-2 py-2 text-center",children:"Fant ikke klubb."})}export{q as default};
